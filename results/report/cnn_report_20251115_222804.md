# CNN Deforestation Detection
## Comprehensive Report

---

**Generated:** 2025-11-15 22:28:05  
**Project:** á»¨ng dá»¥ng Viá»…n thÃ¡m vÃ  Há»c sÃ¢u trong GiÃ¡m sÃ¡t Biáº¿n Ä‘á»™ng Rá»«ng tá»‰nh CÃ  Mau  
**Student:** Ninh Háº£i ÄÄƒng (MSSV: 21021411)  
**Year:** 2025-2026, Há»c ká»³ I

---

## 1. Data Configuration

### Dataset Overview

| **Parameter** | **Value** |
|---------------|-----------|
| **Total Features** | 27 |
| Sentinel-2 Features | 21 (7 before + 7 after + 7 delta) |
| Sentinel-1 Features | 6 (2 before + 2 after + 2 delta) |
| **Ground Truth Points** | 2,630 |
| Class 0 (No Deforestation) | 656 (24.9%) |
| Class 1 (Deforestation) | 650 (24.7%) |

### Patch Configuration

- **Patch Size:** 3Ã—3 pixels
- **Features per Patch:** 27
- **Spatial Context:** 9 pixels per sample
- **Total Patches Extracted:** 2,629

### Data Split

| **Split** | **Patches** | **Percentage** |
|-----------|-------------|----------------|
| Training | 1,838 | 69.9% |
| Validation | 395 | 15.0% |
| Test | 396 | 15.1% |
| **Total** | **2,629** | **100%** |

### Study Area

- **Location:** CÃ  Mau Province, Vietnam
- **Spatial Reference:** EPSG:32648 (WGS 84 / UTM zone 48N)
- **Resolution:** 10m
- **Dimensions:** 12,547 Ã— 10,917 pixels
- **Valid Pixels:** 16,246,925 (11.86%)

---

## 2. Model Configuration

### Algorithm

**2D Convolutional Neural Network (CNN)** - Deep learning approach for spatial pattern recognition

**Device:** `CUDA`

### Network Architecture

```
Input: (3, 3, 27)
    â†“
Conv2D â†’ BatchNorm â†’ ReLU â†’ MaxPool
    â†“
Conv2D â†’ BatchNorm â†’ ReLU â†’ MaxPool
    â†“
Conv2D â†’ BatchNorm â†’ ReLU â†’ MaxPool
    â†“
Flatten
    â†“
Dense â†’ Dropout(0.6) â†’ ReLU
    â†“
Dense â†’ Dropout(0.6) â†’ ReLU
    â†“
Output: 4 classes (Softmax)
```

### Hyperparameters

| **Parameter** | **Value** | **Description** |
|---------------|-----------|-----------------|
| `epochs` | 500 | Maximum training epochs |
| `batch_size` | 64 | Samples per training batch |
| `learning_rate` | 0.001 | Initial learning rate (Adam) |
| `weight_decay` | 0.0005 | L2 regularization strength |
| `dropout_rate` | 0.6 | Dropout probability |
| `early_stopping_patience` | 50 | Epochs to wait before stopping |

### Training Configuration

- **Optimizer:** Adam with weight decay
- **Loss Function:** CrossEntropyLoss with class weights
- **Class Weights:** ['1.0033', '1.0099', '0.9924', '0.9946']
- **Data Normalization:** Standardization (zero mean, unit variance)
- **Spatial Splitting:** Cluster distance = 50.0m

---

## 3. Model Performance

### 3.1 Validation Set Results

**Samples:** 395

| **Metric** | **Score** | **Percentage** |
|------------|-----------|----------------|
| **Accuracy** | 0.9924 | **99.24%** |
| Precision | 0.9926 | 99.26% |
| Recall | 0.9924 | 99.24% |
| F1-Score | 0.9924 | 99.24% |
| ROC-AUC | 0.9993 | 99.93% |

**Confusion Matrix:**

|  | **Predicted: No Loss** | **Predicted: Deforestation** |
|--|------------------------|------------------------------|
| **Actual: No Loss** | 108 (TN) | 3 (FP) |
| **Actual: Deforestation** | 0 (FN) | 92 (TP) |

### 3.2 Test Set Results

**Samples:** 396

| **Metric** | **Score** | **Percentage** |
|------------|-----------|----------------|
| **Accuracy** | 0.9975 | **99.75%** |
| Precision | 0.9975 | 99.75% |
| Recall | 0.9975 | 99.75% |
| F1-Score | 0.9975 | 99.75% |
| ROC-AUC | 0.9990 | 99.90% |

**Confusion Matrix:**

|  | **Predicted: No Loss** | **Predicted: Deforestation** |
|--|------------------------|------------------------------|
| **Actual: No Loss** | 85 (TN) | 1 (FP) |
| **Actual: Deforestation** | 0 (FN) | 103 (TP) |

### 3.3 Training Convergence

| **Metric** | **Value** |
|------------|-----------|
| Best Validation Loss | 0.029457 |
| Best Validation Accuracy | 99.49% |
| Total Training Epochs | 101 |
| Final Training Loss | 0.021512 |
| Final Training Accuracy | 99.51% |
| Final Validation Loss | 0.048182 |
| Final Validation Accuracy | 99.24% |

---

## 4. Prediction Results

### Overview

| **Category** | **Value** |
|--------------|-----------|
| Total Pixels Processed | 136,975,599 |
| Valid Pixels | 16,246,925 (11.86%) |

### Classification Statistics

| **Class** | **Category** | **Pixels** | **Percentage** | **Area (ha)** |
|-----------|--------------|------------|----------------|---------------|
| 0 | ğŸŒ³ No Deforestation | 14,495,446 | 89.22% | 144,954.46 |
| 1 | ğŸ”¥ Deforestation | 1,751,479 | 10.78% | 17,514.79 |

---

## 5. Output Files

### Directory Structure

```
../results/
â”œâ”€â”€ rasters/
â”‚   â”œâ”€â”€ cnn_classification.tif
â”‚   â””â”€â”€ cnn_probability.tif
â”œâ”€â”€ models/
â”‚   â””â”€â”€ cnn_model.pth
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ cnn_evaluation_metrics.json
â”‚   â”œâ”€â”€ cnn_training_history.json
â”‚   â””â”€â”€ cnn_training_patches.npz
â”œâ”€â”€ plots/
â”‚   â”œâ”€â”€ cnn_training_curves.png
â”‚   â”œâ”€â”€ cnn_confusion_matrices.png
â”‚   â”œâ”€â”€ cnn_roc_curve.png
â”‚   â””â”€â”€ cnn_classification_maps.png
â””â”€â”€ report/
    â””â”€â”€ cnn_report_20251115_222804.md
```

---

## 6. Execution Summary

| **Metric** | **Value** |
|------------|-----------|
| Training Time | 0.47 minutes (28.2 seconds) |
| Prediction Time | 15.05 minutes (902.8 seconds) |
| **Total Pipeline Time** | **15.52 minutes** |
| Model Parameters | ~50K (lightweight architecture) |
| Computing Device | CUDA |

### Normalization

- **Method:** Standardization (applied consistently)
- **Mean shape:** (1, 1, 1, 27)
- **Std shape:** (1, 1, 1, 27)

---

## 7. Key Findings

### ğŸ¯ Model Performance

- The CNN model achieved **99.75% accuracy** on the test set
- **High precision (99.75%)** â†’ low false positive rate
- **High recall (99.75%)** â†’ effective deforestation detection
- **Excellent ROC-AUC (0.9990)** â†’ strong discriminative ability

### ğŸŒŸ Spatial Context Benefits

- **3Ã—3 patches** capture local spatial patterns
- CNN architecture **learns features automatically** from raw data
- Results show **smoother classification maps** vs pixel-based methods
- Neighboring pixel relationships enhance detection accuracy

### ğŸ”¥ Deforestation Detection

- **Detected:** 1,751,479 deforestation pixels
- **Area:** 17,514.79 hectares deforested
- **Preserved:** 144,954.46 hectares intact forest

### ğŸ’ª Model Robustness

- **Validation accuracy:** 99.24%
- **Test accuracy:** 99.75%
- **Consistent performance** across validation and test sets
- **Early stopping** prevented overfitting

### ğŸ† Technical Achievements

- âœ… Spatial-aware data splitting (cluster-based)
- âœ… Avoided data leakage through proper validation
- âœ… Consistent normalization for training and prediction
- âœ… Lightweight model (~50K params) suitable for deployment

---

## 8. Comparison: CNN vs Random Forest

### Methodological Differences

| **Aspect** | **CNN (This Model)** | **Random Forest** |
|------------|---------------------|-------------------|
| **Input** | 3Ã—3 patches | Individual pixels |
| **Feature Learning** | Automatic (learned) | Hand-crafted indices |
| **Spatial Context** | âœ… Yes (patch-based) | âŒ No (pixel-based) |
| **Training Time** | 0.5 min | ~1-2 min |
| **Prediction Time** | 15.0 min | ~5-10 min |

### Performance Metrics

| **Metric** | **CNN** | **RF** (typical) |
|------------|---------|------------------|
| **Test Accuracy** | **99.75%** | ~98% |
| **F1-Score** | 99.75% | ~98% |
| **ROC-AUC** | 99.90% | ~99.8% |

### Advantages of CNN

- ğŸŒ **Spatial context awareness** through patch-based approach
- ğŸ¤– **Automatic feature learning** - no manual feature engineering
- ğŸ¨ **Smoother maps** - reduced salt-and-pepper noise
- ğŸ”— **Relationship modeling** - learns neighboring pixel interactions

---

## 9. Conclusions

The CNN model demonstrates **strong capability** in deforestation detection using spatial context from Sentinel-1/2 imagery.

### Strengths

- âœ… High accuracy (99.75%) with spatial context
- âœ… Automatic feature learning from raw bands
- âœ… Smoother, more realistic classification maps
- âœ… Robust to local variations through patch-based approach

### Limitations

- âš ï¸ Longer training time compared to RF
- âš ï¸ Requires more computational resources (GPU recommended)
- âš ï¸ Less interpretable than RF (black box model)

### Recommendations

- âœ¨ **Operational deployment** for forest monitoring systems
- ğŸ”„ **Periodic retraining** with updated ground truth data
- ğŸ“Š **Ensemble approach** - combine CNN + RF predictions
- ğŸŒ **Scale up** to other provinces or larger regions
- ğŸ¯ **Fine-tuning** for specific forest types or seasons

---

## 10. Future Work

1. **Data Augmentation** - Rotate/flip patches to increase training data
2. **Architecture Optimization** - Test deeper networks or attention mechanisms
3. **Multi-temporal Analysis** - Use time series data for change detection
4. **Transfer Learning** - Pre-train on larger satellite datasets
5. **Real-time Monitoring** - Deploy for continuous forest surveillance

---

**Report generated by CNN Deforestation Detection Pipeline**  
**Contact:** Ninh Háº£i ÄÄƒng (MSSV: 21021411)  
**Generated:** 2025-11-15 22:28:06
