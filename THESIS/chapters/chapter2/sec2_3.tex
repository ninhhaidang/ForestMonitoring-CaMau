\section{Phương pháp phân loại ảnh viễn thám}

\subsection{Các phương pháp phân loại ảnh}

Trong phân loại ảnh viễn thám, có hai phương pháp tiếp cận chính: phân loại dựa trên pixel và phân loại dựa trên patch \cite{blaschke2010, zhang2016}.

\textbf{Pixel-based Classification:}

Mỗi pixel được phân loại độc lập dựa trên vector đặc trưng:
\begin{equation}
\mathbf{x}_i = [f_1, f_2, ..., f_n], \quad y_i = \text{classifier}(\mathbf{x}_i)
\end{equation}

\textbf{Ưu điểm:} Đơn giản, dễ triển khai, tốc độ xử lý nhanh.

\textbf{Nhược điểm:} Không tận dụng ngữ cảnh không gian, dễ tạo ra nhiễu dạng salt-and-pepper.

\textbf{Patch-based Classification:}

Trích xuất patches (windows) xung quanh mỗi pixel:
\begin{equation}
P_i = \text{extract\_patch}(I, \text{center}=(row_i, col_i), \text{size}=k \times k)
\end{equation}
\begin{equation}
y_i = \text{classifier}(P_i)
\end{equation}

\textbf{Ưu điểm:} Sử dụng ngữ cảnh không gian, kết quả mượt hơn, phù hợp với CNN.

\subsection{Ma trận nhầm lẫn và các độ đo đánh giá}

Confusion Matrix (Ma trận nhầm lẫn) là công cụ cơ bản để đánh giá hiệu suất của mô hình phân loại, đặc biệt quan trọng trong các bài toán phân loại ảnh viễn thám \cite{foody2002}. Ma trận này tổng hợp kết quả dự đoán của mô hình so với nhãn thực tế.

\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|}
\hline
& \textbf{Predicted Positive} & \textbf{Predicted Negative} \\
\hline
\textbf{Actual Positive} & True Positive (TP) & False Negative (FN) \\
\hline
\textbf{Actual Negative} & False Positive (FP) & True Negative (TN) \\
\hline
\end{tabular}
\caption{Cấu trúc Confusion Matrix nhị phân}
\label{tab:confusion_matrix_binary}
\end{table}

Ma trận nhầm lẫn bao gồm bốn thành phần chính. \textbf{True Positive (TP)} là số mẫu dương được dự đoán đúng là dương — trong bài toán phát hiện mất rừng, đây là các điểm thực sự mất rừng và mô hình dự đoán đúng. \textbf{True Negative (TN)} là số mẫu âm được dự đoán đúng là âm. \textbf{False Positive (FP)} là số mẫu âm bị dự đoán nhầm là dương (lỗi loại I). \textbf{False Negative (FN)} là số mẫu dương bị dự đoán nhầm là âm (lỗi loại II). Với bài toán phân loại $K$ lớp, Confusion Matrix có kích thước $K \times K$:
\begin{equation}
C_{ij} = \text{số mẫu thuộc lớp } i \text{ được dự đoán là lớp } j
\end{equation}

\textbf{Các độ đo đánh giá:}

Các chỉ số đánh giá được tính toán dựa trên Confusion Matrix để đo lường hiệu suất phân loại từ nhiều góc độ khác nhau \cite{sokolova2009}.

\textbf{Accuracy:}
\begin{equation}
\text{Accuracy} = \frac{TP + TN}{TP + TN + FP + FN}
\end{equation}

\textbf{Precision (Positive Predictive Value):}
\begin{equation}
\text{Precision} = \frac{TP}{TP + FP}
\end{equation}

\textbf{Recall (Sensitivity, True Positive Rate):}
\begin{equation}
\text{Recall} = \frac{TP}{TP + FN}
\end{equation}

\textbf{F1-Score (Harmonic Mean):}
\begin{equation}
F1 = 2 \times \frac{\text{Precision} \times \text{Recall}}{\text{Precision} + \text{Recall}}
\end{equation}

\textbf{ROC-AUC (Area Under ROC Curve):}

Các tiêu chuẩn diễn giải ROC-AUC theo Hosmer và Lemeshow \cite{hosmer2013}: AUC = 0.5 tương ứng với classifier ngẫu nhiên; 0.5 < AUC < 0.7 là phân biệt kém; 0.7 $\leq$ AUC < 0.8 là chấp nhận được; 0.8 $\leq$ AUC < 0.9 là xuất sắc; và AUC $\geq$ 0.9 là vượt trội.

\subsection{Cross Validation, chuẩn hóa dữ liệu và rò rỉ dữ liệu}

\textbf{Cross Validation (Kiểm định chéo):}

Cross Validation là phương pháp đánh giá mô hình giúp ước lượng khả năng generalization của mô hình trên dữ liệu chưa thấy, đồng thời giảm thiểu bias do cách chia dữ liệu \cite{kohavi1995}. Trong K-Fold Cross Validation, dữ liệu được chia thành $K$ phần bằng nhau, mỗi vòng lặp sử dụng một fold làm tập kiểm tra và $K-1$ folds còn lại làm tập huấn luyện:
\begin{equation}
\text{CV Score} = \frac{1}{K} \sum_{i=1}^{K} \text{Score}_i
\end{equation}

Stratified K-Fold là biến thể đảm bảo tỷ lệ các lớp trong mỗi fold tương đương với tỷ lệ trong toàn bộ tập dữ liệu, đặc biệt quan trọng khi dữ liệu mất cân bằng giữa các lớp. Cross Validation mang lại nhiều lợi ích: tận dụng tối đa dữ liệu cho cả huấn luyện và đánh giá, giảm variance trong ước lượng hiệu suất, và phát hiện overfitting hiệu quả hơn.

\textbf{Chuẩn hóa dữ liệu (Data Normalization):}

Chuẩn hóa dữ liệu là bước tiền xử lý quan trọng trong học máy, giúp các features có cùng scale và cải thiện hiệu suất huấn luyện \cite{sola1997}. Z-score Normalization chuyển đổi dữ liệu về phân phối với trung bình bằng 0 và độ lệch chuẩn bằng 1:
\begin{equation}
z = \frac{x - \mu}{\sigma}
\end{equation}

Việc chuẩn hóa dữ liệu cho CNN là cần thiết vì các features có scale khác nhau (ví dụ: NDVI trong $[-1, 1]$, backscatter trong $[-25, 0]$ dB) sẽ ảnh hưởng không đều đến gradient. \textbf{Lưu ý quan trọng:} Các tham số $\mu$ và $\sigma$ phải được tính trên tập huấn luyện và áp dụng cho cả tập kiểm tra để tránh rò rỉ dữ liệu.

\textbf{Dữ liệu thực địa (Ground Truth):}

Dữ liệu thực địa là tập dữ liệu tham chiếu với nhãn chính xác, được sử dụng để huấn luyện và đánh giá mô hình phân loại \cite{foody2002}. Trong viễn thám, dữ liệu thực địa có thể thu thập từ khảo sát thực địa, diễn giải ảnh độ phân giải cao, hoặc dữ liệu lịch sử. Chất lượng dữ liệu thực địa ảnh hưởng trực tiếp đến độ tin cậy của kết quả phân loại.

\textbf{Rò rỉ dữ liệu (Data Leakage):}

Rò rỉ dữ liệu xảy ra khi thông tin từ tập kiểm tra ``rò rỉ'' vào quá trình huấn luyện, dẫn đến kết quả đánh giá quá lạc quan \cite{kaufman2012}. Có ba dạng rò rỉ phổ biến trong viễn thám: (1) \textbf{Rò rỉ không gian} khi các điểm train/test nằm gần nhau về địa lý; (2) \textbf{Rò rỉ thời gian} khi sử dụng thông tin từ thời điểm sau để dự đoán thời điểm trước; (3) \textbf{Rò rỉ đặc trưng} khi tính statistics trên toàn bộ dữ liệu thay vì chỉ trên tập huấn luyện. Trong nghiên cứu này, rò rỉ dữ liệu được phòng tránh bằng cách sử dụng Stratified K-Fold Cross Validation và tính toán các tham số chuẩn hóa riêng cho từng fold.