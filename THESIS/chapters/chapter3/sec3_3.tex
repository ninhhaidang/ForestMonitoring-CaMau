\section{Kiến trúc mô hình CNN đề xuất}

\subsection{Thiết kế kiến trúc}

\begin{figure}[H]
    \centering
    \fbox{\parbox{0.9\textwidth}{\centering\vspace{3cm}\textbf{[PLACEHOLDER]}\\ Sơ đồ kiến trúc CNN chi tiết với các layer,\\ kích thước tensor ở mỗi bước, và số parameters\vspace{3cm}}}
    \caption{Kiến trúc mô hình CNN đề xuất}
    \label{fig:cnn_architecture}
\end{figure}

\textbf{Tổng quan architecture:}

\begin{verbatim}
INPUT: (batch_size, 3, 3, 27)
    |
PERMUTE -> (batch_size, 27, 3, 3)  # PyTorch format (N, C, H, W)
    |
CONVOLUTIONAL BLOCK 1
    Conv2D(27 -> 64, kernel=3x3)
    BatchNorm2D(64)
    ReLU()
    Dropout2D(p=0.7)
    | (batch_size, 64, 3, 3)
CONVOLUTIONAL BLOCK 2
    Conv2D(64 -> 32, kernel=3x3)
    BatchNorm2D(32)
    ReLU()
    Dropout2D(p=0.7)
    | (batch_size, 32, 3, 3)
GLOBAL AVERAGE POOLING
    | (batch_size, 32)
FULLY CONNECTED BLOCK
    Linear(32 -> 64)
    BatchNorm1D(64)
    ReLU()
    Dropout(p=0.7)
    | (batch_size, 64)
OUTPUT LAYER
    Linear(64 -> 4)
    |
OUTPUT: (batch_size, 4)  # Logits for 4 classes
\end{verbatim}

\subsection{Parameter Count}

\begin{table}[H]
\centering
\caption{Tổng số trainable parameters}
\label{tab:parameters}
\begin{tabular}{|l|l|c|l|}
\hline
\textbf{Layer} & \textbf{Type} & \textbf{Parameters} & \textbf{Calculation} \\
\hline
Conv1 & Weights & 15,552 & 27×3×3×64 \\
\hline
BN1 & $\gamma$, $\beta$ & 128 & 64 + 64 \\
\hline
Conv2 & Weights & 18,432 & 64×3×3×32 \\
\hline
BN2 & $\gamma$, $\beta$ & 64 & 32 + 32 \\
\hline
GAP & - & 0 & No params \\
\hline
FC1 & Weights, bias & 2,112 & 32×64 + 64 \\
\hline
BN3 & $\gamma$, $\beta$ & 128 & 64 + 64 \\
\hline
FC2 & Weights, bias & 260 & 64×4 + 4 \\
\hline
\textbf{TOTAL} & & \textbf{36,676} & \\
\hline
\end{tabular}
\end{table}
